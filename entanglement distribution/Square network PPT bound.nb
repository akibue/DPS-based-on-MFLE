Notebook[{Cell[
BoxData[{RowBox[{RowBox[{"TensorN","[",RowBox[{"M_",",","n_"}],"]"}],":=",RowBox[
{"If","[",RowBox[{RowBox[{"n","==","1"}],",",RowBox[{"M","[",RowBox[{"[","1","]"}],"]"}],",",RowBox[
{"KroneckerProduct","[",RowBox[{RowBox[{"TensorN","[",RowBox[{"M",",",RowBox[{"n","-","1"}]}],"]"}],",",RowBox[
{"M","[",RowBox[{"[","n","]"}],"]"}]}],"]"}]}],"]"}]}],"\[IndentingNewLine]",RowBox[
{RowBox[{"Id","[","d_","]"}],":=",RowBox[{"IdentityMatrix","[","d","]"}]}]}],"Input",
CellChangeTimes -> {{3.965906202826919`*^9,3.965906217072625`*^9},{3.9659062897243547`*^9,3.965906294709796`*^9},{3.965906326308646`*^9,3.965906327040349`*^9},{3.965906528362194`*^9,3.96590653983249`*^9}},
CellLabel -> "In[291]:=",ExpressionUUID -> "0669ea66-fc83-4b53-a181-c9738024d205"],Cell[
CellGroupData[
{Cell[
BoxData[{RowBox[{RowBox[{"d","=","2"}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"u","=",RowBox[{FractionBox["1","d"],RowBox[{"(",GridBox[{{"1",RowBox[{"d","-","1"}]},{RowBox[
{"-","1"}],RowBox[{"d","+","1"}]}}],")"}]}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"svec","=",RowBox[{"Table","[",RowBox[{RowBox[{"If","[",RowBox[{RowBox[{"i","==","0"}],",",RowBox[
{"Subscript","[",RowBox[{"s",",","i"}],"]"}],",",RowBox[{"If","[",RowBox[{RowBox[
{"i",">=","4"}],",",RowBox[{"Subscript","[",RowBox[{"s",",",RowBox[{"i","-","3"}]}],"]"}],",","0"}],"]"}]}],"]"}],",",RowBox[
{"{",RowBox[{"i",",","0",",",RowBox[{SuperscriptBox["2","6"],"-","1"}]}],"}"}]}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"svecA","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",","u",",",RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}],",","u",",",RowBox[
{"Id","[","2","]"}]}],"}"}],",","6"}],"]"}],".",RowBox[{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[
{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[{RowBox[{"svecB","=",RowBox[
{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[{RowBox[{"{",RowBox[
{"u",",",RowBox[{"Id","[","2","]"}],",","u",",",RowBox[{"Id","[","2","]"}],",",RowBox[
{"Id","[","2","]"}],",","u"}],"}"}],",","6"}],"]"}],".",RowBox[{"Transpose","[",RowBox[
{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"svecC","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"Id","[","2","]"}],",","u",",",RowBox[{"Id","[","2","]"}],",","u",",","u",",",RowBox[
{"Id","[","2","]"}]}],"}"}],",","6"}],"]"}],".",RowBox[{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[
{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[{RowBox[{"svecD","=",RowBox[
{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[{RowBox[{"{",RowBox[
{RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}],",","u",",","u",",","u",",",RowBox[
{"Id","[","2","]"}]}],"}"}],",","6"}],"]"}],".",RowBox[{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[
{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[{RowBox[{"svecAB","=",RowBox[
{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[{RowBox[{"{",RowBox[
{RowBox[{"Id","[","2","]"}],",","u",",","u",",",RowBox[{"Id","[","2","]"}],",","u",",","u"}],"}"}],",","6"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"svecAC","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",",RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}],",","u",",","u",",","u"}],"}"}],",","6"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{RowBox[{"svecAD","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",","u",",","u",",","u",",",RowBox[{"Id","[","2","]"}],",",RowBox[
{"Id","[","2","]"}]}],"}"}],",","6"}],"]"}],".",RowBox[{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[
{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvec","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"Id","[","16","]"}],",",RowBox[{"{",RowBox[{"{",RowBox[
{"1",",",RowBox[{SuperscriptBox["d","2"],"-","1"}]}],"}"}],"}"}],",",RowBox[{"{",RowBox[
{"{",RowBox[{"1",",",RowBox[{SuperscriptBox["d","2"],"-","1"}]}],"}"}],"}"}]}],"}"}],",","3"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","svec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecA","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",","u",",",RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}]}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecB","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",",RowBox[{"Id","[","2","]"}],",","u",",",RowBox[{"Id","[","2","]"}]}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecC","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"Id","[","2","]"}],",","u",",",RowBox[{"Id","[","2","]"}],",","u"}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecD","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}],",","u",",","u"}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecAB","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"Id","[","2","]"}],",","u",",","u",",",RowBox[{"Id","[","2","]"}]}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{"ptrsvecAC","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",",RowBox[{"Id","[","2","]"}],",",RowBox[{"Id","[","2","]"}],",","u"}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]",RowBox[
{RowBox[{RowBox[{"ptrsvecAD","=",RowBox[{RowBox[{"Transpose","[",RowBox[{RowBox[{"TensorN","[",RowBox[
{RowBox[{"{",RowBox[{"u",",","u",",","u",",","u"}],"}"}],",","4"}],"]"}],".",RowBox[
{"Transpose","[",RowBox[{"{","ptrsvec","}"}],"]"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";"}],"\[IndentingNewLine]"}],"\[IndentingNewLine]",RowBox[
{"res","=",RowBox[{"LinearOptimization","[",RowBox[{RowBox[{"-",SubscriptBox["s",
"0"]}],",",RowBox[{"Join","[",RowBox[{RowBox[{"Table","[",RowBox[{RowBox[{RowBox[
{"svec","[",RowBox[{"[","i","]"}],"]"}],">=","0.0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecA","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecB","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecC","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecD","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecAB","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecAC","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"svecAD","[",RowBox[
{"[","i","]"}],"]"}],">=","0"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","6"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvec","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecA","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecB","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecC","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecD","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecAB","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecAC","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{RowBox[{"ptrsvecAD","[",RowBox[
{"[","i","]"}],"]"}],"<=","1"}],",",RowBox[{"{",RowBox[{"i",",","1",",",SuperscriptBox[
"2","4"]}],"}"}]}],"]"}]}],"]"}],",",RowBox[{"Table","[",RowBox[{RowBox[{"Subscript","[",RowBox[
{"s",",","i"}],"]"}],",",RowBox[{"{",RowBox[{"i",",","0",",",RowBox[{SuperscriptBox[
"2","6"],"-","4"}]}],"}"}]}],"]"}]}],"]"}]}],"\[IndentingNewLine]",RowBox[{RowBox[
{"(",SubscriptBox["s","0"],")"}],"/.","res"}]}],"Input",CellChangeTimes -> {{3.965905263397847`*^9,3.965905264826943`*^9},{3.965905313782009`*^9,3.965905321674255`*^9},{3.9659053809487753`*^9,3.965905381631485`*^9},{3.965905417212924`*^9,3.9659054403315077`*^9},{3.9659054898086233`*^9,3.96590564758746`*^9},{3.965905756052006`*^9,3.965905930414103`*^9},{3.965905970460864`*^9,3.9659060229354963`*^9},{3.96590608605606`*^9,3.9659061106378403`*^9},{3.965906445230686`*^9,3.965906520551955`*^9},3.9659065667287827`*^9,{3.965906609936895`*^9,3.965906683960898`*^9},{3.96590672369013`*^9,3.9659067780936403`*^9},{3.9659068428556128`*^9,3.965907056888509`*^9},{3.965907143952031`*^9,3.965907144160404`*^9},{3.965907207716446`*^9,3.965907325230638`*^9},{3.965907384953196`*^9,3.965907548073758`*^9}},
CellLabel -> "In[615]:=",ExpressionUUID -> "55c873de-c770-4798-a6aa-fb9b408a6884"],Cell[
BoxData[
RowBox[{"{",RowBox[{RowBox[{SubscriptBox["s","0"],"\[Rule]","0.9248120300751879`"}],",",RowBox[
{SubscriptBox["s","1"],"\[Rule]","0.`"}],",",RowBox[{SubscriptBox["s","2"],"\[Rule]","0.06237816764132589`"}],",",RowBox[
{SubscriptBox["s","3"],"\[Rule]","0.11668059036480048`"}],",",RowBox[{SubscriptBox[
"s","4"],"\[Rule]","0.048640118815557416`"}],",",RowBox[{SubscriptBox["s","5"],"\[Rule]","0.04177109440267274`"}],",",RowBox[
{SubscriptBox["s","6"],"\[Rule]","0.11668059036480101`"}],",",RowBox[{SubscriptBox[
"s","7"],"\[Rule]","0.07351712614870556`"}],",",RowBox[{SubscriptBox["s","8"],"\[Rule]","0.04028589993502255`"}],",",RowBox[
{SubscriptBox["s","9"],"\[Rule]","0.07490949596212779`"}],",",RowBox[{SubscriptBox[
"s","10"],"\[Rule]","0.05968625266870825`"}],",",RowBox[{SubscriptBox["s","11"],"\[Rule]","0.15696649029982337`"}],",",RowBox[
{SubscriptBox["s","12"],"\[Rule]","0.029642006250193642`"}],",",RowBox[{SubscriptBox[
"s","13"],"\[Rule]","0.`"}],",",RowBox[{SubscriptBox["s","14"],"\[Rule]","0.062378167641326`"}],",",RowBox[
{SubscriptBox["s","15"],"\[Rule]","0.11668059036480047`"}],",",RowBox[{SubscriptBox[
"s","16"],"\[Rule]","0.04864011881555736`"}],",",RowBox[{SubscriptBox["s","17"],"\[Rule]","0.0888331940963524`"}],",",RowBox[
{SubscriptBox["s","18"],"\[Rule]","0.03137473312911943`"}],",",RowBox[{SubscriptBox[
"s","19"],"\[Rule]","0.1416504223521766`"}],",",RowBox[{SubscriptBox["s","20"],"\[Rule]","0.04263745784213612`"}],",",RowBox[
{SubscriptBox["s","21"],"\[Rule]","0.`"}],",",RowBox[{SubscriptBox["s","22"],"\[Rule]","0.05142485844240254`"}],",",RowBox[
{SubscriptBox["s","23"],"\[Rule]","0.04028589993502245`"}],",",RowBox[{SubscriptBox[
"s","24"],"\[Rule]","0.07961261177635465`"}],",",RowBox[{SubscriptBox["s","25"],"\[Rule]","0.06377053745474841`"}],",",RowBox[
{SubscriptBox["s","26"],"\[Rule]","0.018441164639995313`"}],",",RowBox[{SubscriptBox[
"s","27"],"\[Rule]","0.07206287323246373`"}],",",RowBox[{SubscriptBox["s","28"],"\[Rule]","0.07354806770011445`"}],",",RowBox[
{SubscriptBox["s","29"],"\[Rule]","0.041771094402673285`"}],",",RowBox[{SubscriptBox[
"s","30"],"\[Rule]","0.11668059036480047`"}],",",RowBox[{SubscriptBox["s","31"],"\[Rule]","0.0735171261487053`"}],",",RowBox[
{SubscriptBox["s","32"],"\[Rule]","0.040285899935022795`"}],",",RowBox[{SubscriptBox[
"s","33"],"\[Rule]","0.`"}],",",RowBox[{SubscriptBox["s","34"],"\[Rule]","0.05142485844240237`"}],",",RowBox[
{SubscriptBox["s","35"],"\[Rule]","0.04028589993502279`"}],",",RowBox[{SubscriptBox[
"s","36"],"\[Rule]","0.07961261177635441`"}],",",RowBox[{SubscriptBox["s","37"],"\[Rule]","0.07490949596212784`"}],",",RowBox[
{SubscriptBox["s","38"],"\[Rule]","0.12772672421795234`"}],",",RowBox[{SubscriptBox[
"s","39"],"\[Rule]","0.02487700733314796`"}],",",RowBox[{SubscriptBox["s","40"],"\[Rule]","0.05099167672267077`"}],",",RowBox[
{SubscriptBox["s","41"],"\[Rule]","0.054488072031932074`"}],",",RowBox[{SubscriptBox[
"s","42"],"\[Rule]","0.041925802159720485`"}],",",RowBox[{SubscriptBox["s","43"],"\[Rule]","0.05786070113555453`"}],",",RowBox[
{SubscriptBox["s","44"],"\[Rule]","0.07148529760615528`"}],",",RowBox[{SubscriptBox[
"s","45"],"\[Rule]","0.0749094959621273`"}],",",RowBox[{SubscriptBox["s","46"],"\[Rule]","0.05968625266870881`"}],",",RowBox[
{SubscriptBox["s","47"],"\[Rule]","0.1569664902998236`"}],",",RowBox[{SubscriptBox[
"s","48"],"\[Rule]","0.02964200625019338`"}],",",RowBox[{SubscriptBox["s","49"],"\[Rule]","0.06377053745474819`"}],",",RowBox[
{SubscriptBox["s","50"],"\[Rule]","0.018441164639994758`"}],",",RowBox[{SubscriptBox[
"s","51"],"\[Rule]","0.07206287323246395`"}],",",RowBox[{SubscriptBox["s","52"],"\[Rule]","0.07354806770011446`"}],",",RowBox[
{SubscriptBox["s","53"],"\[Rule]","0.05448807203193192`"}],",",RowBox[{SubscriptBox[
"s","54"],"\[Rule]","0.041925802159720055`"}],",",RowBox[{SubscriptBox["s","55"],"\[Rule]","0.05786070113555504`"}],",",RowBox[
{SubscriptBox["s","56"],"\[Rule]","0.07148529760615538`"}],",",RowBox[{SubscriptBox[
"s","57"],"\[Rule]","0.06290417401528528`"}],",",RowBox[{SubscriptBox["s","58"],"\[Rule]","0.035232113204822633`"}],",",RowBox[
{SubscriptBox["s","59"],"\[Rule]","0.07104180203595427`"}],",",RowBox[{SubscriptBox[
"s","60"],"\[Rule]","0.06859398152445581`"}]}],"}"}]],"Output",CellChangeTimes -> {3.9659054430418863`*^9,{3.9659055406811733`*^9,3.96590556026641`*^9},3.965905648916295`*^9,{3.9659058022896347`*^9,3.965905813900282`*^9},{3.9659059192172194`*^9,3.965905930727624`*^9},{3.9659059985926237`*^9,3.965906023286368`*^9},3.965906567952715`*^9,{3.965906610844942`*^9,3.96590662269309`*^9},3.9659066875221987`*^9,{3.965906738049005`*^9,3.9659067526252613`*^9},3.9659068649310617`*^9,3.965907155638248`*^9,3.965907208579802`*^9,{3.965907442999571`*^9,3.96590754862502`*^9}},
CellLabel -> "Out[633]=",ExpressionUUID -> "d8776ddc-29fa-42ae-8102-70ba8f6e836f"],Cell[
BoxData[
"0.9248120300751879`"],"Output",CellChangeTimes -> {3.9659054430418863`*^9,{3.9659055406811733`*^9,3.96590556026641`*^9},3.965905648916295`*^9,{3.9659058022896347`*^9,3.965905813900282`*^9},{3.9659059192172194`*^9,3.965905930727624`*^9},{3.9659059985926237`*^9,3.965906023286368`*^9},3.965906567952715`*^9,{3.965906610844942`*^9,3.96590662269309`*^9},3.9659066875221987`*^9,{3.965906738049005`*^9,3.9659067526252613`*^9},3.9659068649310617`*^9,3.965907155638248`*^9,3.965907208579802`*^9,{3.965907442999571`*^9,3.9659075486268578`*^9}},
CellLabel -> "Out[634]=",ExpressionUUID -> "5f7f1151-d8e4-4514-aaea-5b7f5b23e439"]},
Open],ExpressionUUID -> "6d0cfde5-90fa-4f1d-9c1d-492ab2d29d63"],Cell[
BoxData[""],
"Input",ExpressionUUID -> "097343eb-4f7d-42e9-9b7e-a6dbef1811c4"],Cell[
BoxData[{RowBox[
{RowBox[{"(*"," ",RowBox[{"Operator"," ","Schmidt"," ","rank"," ","for"," ","4","\[Times]","4"," ","operators"," ",RowBox[
{"(",RowBox[{"on"," ",RowBox[{"2","\[CircleTimes]","2"}]}],")"}]}]," ","*)"}],"\n",RowBox[
{RowBox[{"OpSchmidtRank4","[",RowBox[{"X_",","," ",RowBox[{"tol_",":"," ","1.*^-12"}]}],"]"}]," ",":="," ",RowBox[
{"Module","[",RowBox[{RowBox[{"{",RowBox[{"T",","," ","R"}],"}"}],",","\n","  ",RowBox[
{RowBox[{"If","[",RowBox[{RowBox[{RowBox[{"Dimensions","[","X","]"}]," ","=!="," ",RowBox[
{"{",RowBox[{"4",","," ","4"}],"}"}]}],","," ",RowBox[{"Return","[","$Failed","]"}]}],"]"}],";","\n","  ",RowBox[
{"T"," ","="," ",RowBox[{"ArrayReshape","[",RowBox[{"X",","," ",RowBox[{"{",RowBox[
{"2",","," ","2",","," ","2",","," ","2"}],"}"}]}],"]"}]}],";","\n","  ",RowBox[{"R"," ","="," ",RowBox[
{"ArrayReshape","[",RowBox[{RowBox[{"Transpose","[",RowBox[{"T",","," ",RowBox[{"{",RowBox[
{"1",","," ","3",","," ","2",","," ","4"}],"}"}]}],"]"}],","," ",RowBox[{"{",RowBox[
{"4",","," ","4"}],"}"}]}],"]"}]}],";","\n","  ",RowBox[{"MatrixRank","[",RowBox[
{"R",","," ",RowBox[{"Tolerance"," ","\[Rule]"," ","tol"}]}],"]"}]}]}],"\n","]"}]}]}],"\n",RowBox[
{RowBox[{"SwapMatrixTensor","[",RowBox[{"d_Integer","?","Positive"}],"]"}]," ",":="," ",RowBox[
{"Module","[",RowBox[{RowBox[{"{",RowBox[{"I"," ","="," ",RowBox[{"IdentityMatrix","[",RowBox[
{"d","^","2"}],"]"}]}],"}"}],",","\n","  ",RowBox[{"ArrayReshape","[","\n","    ",RowBox[
{RowBox[{"Transpose","[",RowBox[{RowBox[{"ArrayReshape","[",RowBox[{"I",","," ",RowBox[
{"{",RowBox[{"d",","," ","d",","," ","d",","," ","d"}],"}"}]}],"]"}],","," ",RowBox[
{"{",RowBox[{"1",","," ","2",","," ","4",","," ","3"}],"}"}]}],"]"}],",","\n","    ",RowBox[
{"{",RowBox[{RowBox[{"d","^","2"}],","," ",RowBox[{"d","^","2"}]}],"}"}]}],"\n","  ","]"}]}],"\n","]"}]}]}],
"Input",CellLabel -> "In[1]:= ",ExpressionUUID -> "26989b78-d507-453c-8bbc-99b690f874f8"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"MatrixForm","[",RowBox[{RowBox[{"c","^","3"}],RowBox[{RowBox[
{"SwapMatrixTensor","[","2","]"}],".",RowBox[{"Inverse","[",RowBox[{RowBox[{"KroneckerProduct","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{"0",",","1"}],"}"}],",",RowBox[{"{",RowBox[
{"0",",","0"}],"}"}]}],"}"}],",",RowBox[{"IdentityMatrix","[","2","]"}]}],"]"}],"+",RowBox[
{"KroneckerProduct","[",RowBox[{RowBox[{"IdentityMatrix","[","2","]"}],",",RowBox[
{"{",RowBox[{RowBox[{"{",RowBox[{"c",",","1"}],"}"}],",",RowBox[{"{",RowBox[{"0",",","c"}],"}"}]}],"}"}]}],"]"}]}],"]"}]}]}],"]"}]],
"Input",NumberMarks -> False,CellLabel -> "In[11]:= ",ExpressionUUID -> "b4ee02ce-a421-431e-9d74-81cbf3bf03cd"],Cell[
BoxData[
TagBox[RowBox[{"(","\[NoBreak]",GridBox[{{SuperscriptBox["c","2"],RowBox[{"-","c"}],RowBox[
{"-","c"}],"2"},{"0","0",SuperscriptBox["c","2"],RowBox[{"-","c"}]},{"0",SuperscriptBox[
"c","2"],"0",RowBox[{"-","c"}]},{"0","0","0",SuperscriptBox["c","2"]}},RowSpacings -> 1,
ColumnSpacings -> 1,RowAlignments -> Baseline,ColumnAlignments -> Center],"\[NoBreak]",")"}],
Function[BoxForm`e$,MatrixForm[BoxForm`e$]]],StandardForm],"Output",CellLabel -> "Out[11]//MatrixForm= ",
ExpressionUUID -> "abbbe86e-0eab-4fe4-b148-91b608664106"]},Open],ExpressionUUID -> "79782de7-0f32-4d7b-930b-d0b596c97732"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"MatrixForm","[",RowBox[{RowBox[{RowBox[{"(",RowBox[{RowBox[
{"a"," ","b"}],"+","1"}],")"}],"^","4"}],RowBox[{RowBox[{"SwapMatrixTensor","[","2","]"}],".",RowBox[
{"Inverse","[",RowBox[{RowBox[{"IdentityMatrix","[","4","]"}],"+",RowBox[{"KroneckerProduct","[",RowBox[
{RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{"a",",","1"}],"}"}],",",RowBox[{"{",RowBox[
{"0",",","a"}],"}"}]}],"}"}],",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{"b",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"0",",","b"}],"}"}]}],"}"}]}],"]"}]}],"]"}]}]}],"]"}]],"Input",CellLabel -> "In[4]:= ",
ExpressionUUID -> "58608e7f-bfe9-4c3f-a21e-7db764d88944"],Cell[
BoxData[TagBox[RowBox[
{"(","\[NoBreak]",GridBox[{{SuperscriptBox[RowBox[{"(",RowBox[{"1","+",RowBox[{"a"," ","b"}]}],")"}],
"3"],RowBox[{RowBox[{"-","a"}],"-",RowBox[{"2"," ",SuperscriptBox["a","2"]," ","b"}],"-",RowBox[
{SuperscriptBox["a","3"]," ",SuperscriptBox["b","2"]}]}],RowBox[{RowBox[{"-","b"}],"-",RowBox[
{"2"," ","a"," ",SuperscriptBox["b","2"]}],"-",RowBox[{SuperscriptBox["a","2"]," ",SuperscriptBox[
"b","3"]}]}],RowBox[{RowBox[{"-","1"}],"+",RowBox[{SuperscriptBox["a","2"]," ",SuperscriptBox[
"b","2"]}]}]},{"0","0",SuperscriptBox[RowBox[{"(",RowBox[{"1","+",RowBox[{"a"," ","b"}]}],")"}],
"3"],RowBox[{RowBox[{"-","a"}]," ",SuperscriptBox[RowBox[{"(",RowBox[{"1","+",RowBox[
{"a"," ","b"}]}],")"}],"2"]}]},{"0",SuperscriptBox[RowBox[{"(",RowBox[{"1","+",RowBox[
{"a"," ","b"}]}],")"}],"3"],"0",RowBox[{RowBox[{"-","b"}]," ",SuperscriptBox[RowBox[
{"(",RowBox[{"1","+",RowBox[{"a"," ","b"}]}],")"}],"2"]}]},{"0","0","0",SuperscriptBox[
RowBox[{"(",RowBox[{"1","+",RowBox[{"a"," ","b"}]}],")"}],"3"]}},RowSpacings -> 1,
ColumnSpacings -> 1,RowAlignments -> Baseline,ColumnAlignments -> Center],"\[NoBreak]",")"}],
Function[BoxForm`e$,MatrixForm[BoxForm`e$]]],StandardForm],"Output",CellLabel -> "Out[4]//MatrixForm= ",
ExpressionUUID -> "9b50b504-7c1e-48d5-9ef4-b6daf5094830"]},Open],ExpressionUUID -> "9194f09b-7fb1-4995-bf49-192dd168ce75"]},
StyleDefinitions -> "Default.nb",WindowSize -> {808,907},WindowMargins -> {{Automatic,233},{-159,Automatic}},
FrontEndVersion -> "14.3 for Wolfram Cloud 1.73 (July 23, 2025)",ExpressionUUID -> "1822eb32-771f-4eae-94f4-f47163f8a53f"]